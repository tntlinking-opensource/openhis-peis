<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.center.medical.report.dao.HealthAuditMapper">

    <resultMap type="com.center.medical.bean.model.Report" id="ReportMap">
        <id property="id" column="id"/>
        <result property="patientcode" column="patientcode"/>
        <result property="createdate" column="createdate"/>
        <result property="modifydate" column="modifydate"/>
        <result property="diseaseHealth" column="disease_health"/>
        <result property="isPrintMessage" column="is_print_message"/>
        <result property="urlWord" column="url_word"/>
        <result property="urlPdf" column="url_pdf"/>
        <result property="status" column="status"/>
        <result property="isTotal" column="is_total"/>
        <result property="printMan" column="print_man"/>
        <result property="printId" column="print_id"/>
        <result property="printTime" column="print_time"/>
        <result property="createNum" column="create_num"/>
        <result property="printNum" column="print_num"/>
        <result property="firstId" column="first_id"/>
        <result property="firstMan" column="first_man"/>
        <result property="firstTime" column="first_time"/>
        <result property="firstReason" column="first_reason"/>
        <result property="secondId" column="second_id"/>
        <result property="secondMan" column="second_man"/>
        <result property="secondTime" column="second_time"/>
        <result property="secondReason" column="second_reason"/>
        <result property="lastId" column="last_id"/>
        <result property="lastMan" column="last_man"/>
        <result property="lastTime" column="last_time"/>
        <result property="lastReason" column="last_reason"/>
        <result property="joinPersonId" column="join_person_id"/>
        <result property="joinPersonMan" column="join_person_man"/>
        <result property="joinTime" column="join_time"/>
        <result property="revPersonId" column="rev_person_id"/>
        <result property="revPersonMan" column="rev_person_man"/>
        <result property="revTime" column="rev_time"/>
        <result property="grantId" column="grant_id"/>
        <result property="chestNum" column="chest_num"/>
        <result property="notificationResult" column="notification_result"/>
        <result property="getterId" column="getter_id"/>
        <result property="getterPhone" column="getter_phone"/>
        <result property="getterName" column="getter_name"/>
        <result property="issueId" column="issue_id"/>
        <result property="returnId" column="return_id"/>
        <result property="getTime" column="get_time"/>
        <result property="returnTime" column="return_time"/>
        <result property="expressId" column="express_id"/>
        <result property="expressNum" column="express_num"/>
        <result property="patientname" column="patientname"/>
        <result property="sex" column="sex"/>
        <result property="age" column="age"/>
        <result property="idOrg" column="id_org"/>
        <result property="orgName" column="org_name"/>
        <result property="dateregister" column="dateregister"/>
        <result property="phone" column="phone"/>
        <result property="idOpendoctor" column="id_opendoctor"/>
        <result property="doctorapply" column="doctorapply"/>
        <result property="idDoctorfinal" column="id_doctorfinal"/>
        <result property="doctorfinalNameR" column="doctorfinal_name_r"/>
        <result property="datefinalexamed" column="datefinalexamed"/>
        <result property="numorgresv" column="numorgresv"/>
        <result property="tbbz" column="tbbz"/>
        <result property="notifyDate" column="notify_date"/>
        <result property="notifyMemo" column="notify_memo"/>
        <result property="generateName" column="generate_name"/>
        <result property="generateHint" column="generate_hint"/>
        <result property="generateDate" column="generate_date"/>
        <result property="shortCode" column="short_code"/>
        <result property="configId" column="config_id"/>
        <result property="isNuclein" column="is_nuclein"/>
        <result property="noticer" column="noticer"/>
    </resultMap>

    <!-- 数据表字段属性 -->
    <sql id="selectReportVo">
        select id,
               patientcode,
               createdate,
               modifydate,
               disease_health,
               is_print_message,
               url_word,
               url_pdf,
               status,
               is_total,
               print_man,
               print_id,
               print_time,
               create_num,
               print_num,
               first_id,
               first_man,
               first_time,
               first_reason,
               second_id,
               second_man,
               second_time,
               second_reason,
               last_id,
               last_man,
               last_time,
               last_reason,
               join_person_id,
               join_person_man,
               join_time,
               rev_person_id,
               rev_person_man,
               rev_time,
               grant_id,
               chest_num,
               notification_result,
               getter_id,
               getter_phone,
               getter_name,
               issue_id,
               return_id,
               get_time,
               return_time,
               express_id,
               express_num,
               patientname,
               sex,
               age,
               id_org,
               org_name,
               dateregister,
               phone,
               id_opendoctor,
               doctorapply,
               id_doctorfinal,
               doctorfinal_name_r,
               datefinalexamed,
               numorgresv,
               tbbz,
               notify_date,
               notify_memo,
               generate_name,
               generate_hint,
               generate_date,
               short_code,
               config_id,
               is_nuclein,
               noticer
        from md_report
    </sql>

    <!-- 查询一审列表数据 -->
    <select id="getFirstListData" resultMap="ReportMap">
        <include refid="selectReportVo"/>
        <where>
            disease_health = 0
            <if test="param.patientcode != null">
                AND patientcode = #{param.patientcode}
            </if>
            <if test="param.numorgresv != null">
                AND numorgresv = #{param.numorgresv}
            </if>
            <if test="param.flag != null">
                AND status <![CDATA[ > ]]> 1
            </if>
            <if test="param.status == 0">
                AND status = 2
            </if>
            <if test="param.status != null and param.status != 0">
                AND status = #{param.status}
            </if>
        </where>
    </select>

    <!-- 查询复审列表数据 -->
    <select id="getSecondListData" resultMap="ReportMap">
        <include refid="selectReportVo"/>
        <where>
            disease_health = 0
            <if test="param.patientcode != null">
                AND patientcode = #{param.patientcode}
            </if>
            <if test="param.numorgresv != null">
                AND numorgresv = #{param.numorgresv}
            </if>
            <if test="param.status == null">
                AND status <![CDATA[ > ]]> 1
            </if>
            <if test="param.status == 0">
                AND status = 3
            </if>
            <if test="param.status != null and param.status != 0">
                AND status = #{param.status}
            </if>
        </where>
    </select>

    <!-- 查询终审列表数据 -->
    <select id="getLastListData" resultMap="ReportMap">
        <include refid="selectReportVo"/>
        <where>
            disease_health = 0
            <if test="param.patientcode != null">
                AND patientcode = #{param.patientcode}
            </if>
            <if test="param.numorgresv != null">
                AND numorgresv = #{param.numorgresv}
            </if>
            <if test="param.status == null">
                AND status <![CDATA[ >= ]]> 1
            </if>
            <if test="param.status == 0">
                AND status <![CDATA[ >= ]]> 1
                AND status <![CDATA[ <= ]]> 6
            </if>
            <if test="param.status == 7">
                AND status <![CDATA[ >= ]]> 7
                AND status <![CDATA[ <> ]]> 8
            </if>
            <if test="param.status != null and param.status != 0 and param.status != 7">
                AND status = #{param.status}
            </if>
            <if test="param.startTime!=null">
                AND last_time <![CDATA[ >= ]]> #{param.startTime}
            </if>
            <if test="param.endTime!=null">
                AND last_time <![CDATA[ <= ]]> #{param.endTime}
            </if>
        </where>
    </select>

    <!-- 查询一审列表数据 -->
    <select id="getProfessionFirstListData" resultMap="ReportMap">
        <include refid="selectReportVo"/>
        <where>
            disease_health = 1
            <if test="param.patientcode != null">
                AND patientcode = #{param.patientcode}
            </if>
            <if test="param.numorgresv != null">
                AND numorgresv = #{param.numorgresv}
            </if>
            <if test="param.status == null">
                AND status <![CDATA[ > ]]> 1
            </if>
            <if test="param.status == 0">
                AND status = 2
            </if>
            <if test="param.status != null and param.status != 0">
                AND status = #{param.status}
            </if>
        </where>
    </select>


    <!-- 查询复审列表数据 -->
    <select id="getProfessionSecondListData" resultMap="ReportMap">
        <include refid="selectReportVo"/>
        <where>
            disease_health = 1
            <if test="param.patientcode != null">
                AND patientcode = #{param.patientcode}
            </if>
            <if test="param.numorgresv != null">
                AND numorgresv = #{param.numorgresv}
            </if>
            <if test="param.status == null">
                AND status <![CDATA[ > ]]> 1
            </if>
            <if test="param.status == 0">
                AND status = 3
            </if>
            <if test="param.status != null and param.status != 0">
                AND status = #{param.status}
            </if>
        </where>
    </select>

    <!-- 查询终审列表数据 -->
    <select id="getProfessionLastListData" resultMap="ReportMap">
        <include refid="selectReportVo"/>
        <where>
            disease_health = 1
            <if test="param.patientcode != null">
                AND patientcode = #{param.patientcode}
            </if>
            <if test="param.numorgresv != null">
                AND numorgresv = #{param.numorgresv}
            </if>
            <if test="param.status == null">
                AND status <![CDATA[ >= ]]> 1
            </if>
            <if test="param.status == 0">
                AND status <![CDATA[ >= ]]> 1
                AND status <![CDATA[ <= ]]> 6
            </if>
            <if test="param.status == 7">
                AND status <![CDATA[ >= ]]> 7
                AND status <![CDATA[ <> ]]> 8
            </if>
            <if test="param.status != null and param.status != 0 and param.status != 7">
                AND status = #{param.status}
            </if>
            <if test="param.startTime!=null">
                AND last_time <![CDATA[ >= ]]> #{param.startTime}
            </if>
            <if test="param.endTime!=null">
                AND last_time <![CDATA[ <= ]]> #{param.endTime}
            </if>
        </where>
    </select>


</mapper>

