<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.center.medical.dao.FxDetectionMapper">

    <resultMap type="com.center.medical.bean.model.FxDetection" id="FxDetectionMap">
        <id property="id" column="id"/>
        <result property="createdate" column="createdate"/>
        <result property="modifydate" column="modifydate"/>
        <result property="sampleId" column="sample_id"/>
        <result property="depName" column="dep_name"/>
        <result property="depId" column="dep_id"/>
        <result property="conclusion" column="conclusion"/>
        <result property="checkMale" column="check_male"/>
        <result property="checkFemale" column="check_female"/>
        <result property="checkTotal" column="check_total"/>
        <result property="allMale" column="all_male"/>
        <result property="allFemale" column="all_female"/>
        <result property="allTotal" column="all_total"/>
        <result property="detectionMale" column="detection_male"/>
        <result property="detectionFemale" column="detection_female"/>
        <result property="detectionTotal" column="detection_total"/>
        <result property="patientcode" column="patientcode"/>
        <result property="patientname" column="patientname"/>
        <result property="sex" column="sex"/>
        <result property="age" column="age"/>
        <result property="orgDepart" column="org_depart"/>
        <result property="basconclusionId" column="basconclusion_id"/>
        <result property="reportSort" column="report_sort"/>
    </resultMap>

    <!-- 数据表字段属性 -->
    <sql id="selectFxDetectionVo">
        select id,
               createdate,
               modifydate,
               sample_id,
               dep_name,
               dep_id,
               conclusion,
               check_male,
               check_female,
               check_total,
               all_male,
               all_female,
               all_total,
               detection_male,
               detection_female,
               detection_total,
               patientcode,
               patientname,
               sex,
               age,
               org_depart,
               basconclusion_id,
               report_sort
        from md_fx_detection
    </sql>

    <!-- 查询列表数据 -->
    <select id="getList" resultMap="FxDetectionMap">
        <include refid="selectFxDetectionVo"/>
    </select>

    <!-- 根据主键id获取记录详情 -->
    <select id="getInfoById" resultMap="FxDetectionMap">
        <include refid="selectFxDetectionVo"/>
        <where>
            id = #{id}
        </where>
    </select>


    <!-- 检出统计 -->
    <select id="checkanalyze" resultType="com.center.medical.bean.vo.CheckanalyzeVo">
        SELECT DISTINCT
            dep_name,
            conclusion,
            detection_male,
            detection_female,
            detection_total,
            all_male,
            all_female,
            all_total,
            check_male,
            check_female,
            check_total,
            basconclusion_id,
            dep_id,
            report_sort
        FROM
            md_fx_detection
        WHERE
            sample_id = #{reportId}
          AND conclusion != '未见异常'
        ORDER BY
            report_sort ASC,
            detection_total DESC
    </select>
</mapper>

