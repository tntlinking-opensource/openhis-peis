## 一.图片操作模板

### 1. 上传模板

```java
import annotation.com.center.medical.common.Log;
import config.com.center.medical.common.ZhongkangConfig;
import file.utils.com.center.medical.common.FileUploadUtils;
import file.utils.com.center.medical.common.FileUtils;
import file.utils.com.center.medical.common.MimeTypeUtils;
import org.apache.commons.lang3.StringUtils;
import org.springframework.web.multipart.MultipartFile;
/**
 * 上传图片
 */
@PostMapping("/upload")
//@PreAuthorize("@ss.hasPermi('::upload')")
@Log(title = "上传图片", businessType = BusinessType.UPDATE)
@ApiOperation(value = "上传图片", notes = "上传图片")
public R upload(@RequestParam("imgFile") MultipartFile file,@RequestParam("itemsId") String itemsId)throws Exception{
        //获取项目信息
        Items items=itemsService.getById(itemsId);
        if(Objects.nonNull(items)){
        //保存图片
        String path=FileUploadUtils.upload(ZhongkangConfig.getDataPath(),file,MimeTypeUtils.IMAGE_EXTENSION);
        if(StringUtils.isNotBlank(items.getInputcodee())){
        //删除原图片
        FileUtils.deleteFile(ZhongkangConfig.getProfile()+StringUtils.substringAfter(items.getInputcodee(),Constants.RESOURCE_PREFIX));
        }
        //更新项目的图片
        items.setInputcodee(path);
        itemsService.updateById(items);
        return R.ok(path);
        }
        return R.fail("上传图片异常，请联系管理员");
        }
```

### 2.多文件上传

```java

import domain.core.com.center.medical.common.AjaxResult;
import config.com.center.medical.framework.ServerConfig;

@Resource
private ServerConfig serverConfig;
private static final String FILE_DELIMETER=",";
/**
 * 文件上传（多个）
 */
@PostMapping("/uploads")
//@PreAuthorize("@ss.hasPermi('::uploads')")
@Log(title = "我的客户表-文件上传", businessType = BusinessType.UPDATE)
public AjaxResult uploadFiles(List<MultipartFile> files)throws Exception{
        try{
        // 上传文件路径
        String filePath=ZhongkangConfig.getUploadPath();
        List<String> urls=new ArrayList<String>();
        List<String> fileNames=new ArrayList<String>();
        List<String> newFileNames=new ArrayList<String>();
        List<String> originalFilenames=new ArrayList<String>();
        for(MultipartFile file:files){
        // 上传并返回新文件名称
        String fileName=FileUploadUtils.upload(filePath,file);
        String url=serverConfig.getUrl()+fileName;
        urls.add(url);
        fileNames.add(fileName);
        newFileNames.add(FileUtils.getName(fileName));
        originalFilenames.add(file.getOriginalFilename());
        }
        AjaxResult ajax=AjaxResult.success();
        ajax.put("urls",StringUtils.join(urls,FILE_DELIMETER));
        ajax.put("fileNames",StringUtils.join(fileNames,FILE_DELIMETER));
        ajax.put("newFileNames",StringUtils.join(newFileNames,FILE_DELIMETER));
        ajax.put("originalFilenames",StringUtils.join(originalFilenames,FILE_DELIMETER));
        return ajax;
        }catch(Exception e){
        return AjaxResult.error(e.getMessage());
        }
        }
```