<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.center.medical.appadmin.dao.AppArticleMapper">

    <resultMap type="com.center.medical.appadmin.bean.model.AppArticle" id="AppArticleMap">
        <id property="id" column="id"/>
        <result property="type" column="type"/>
        <result property="classify" column="classify"/>
        <result property="thumbnail" column="thumbnail"/>
        <result property="title" column="title"/>
        <result property="content" column="content"/>
        <result property="bz" column="bz"/>
        <result property="status" column="status"/>
        <result property="seq" column="seq"/>
        <result property="isDelete" column="is_delete"/>
        <result property="createdate" column="createdate"/>
        <result property="modifydate" column="modifydate"/>
    </resultMap>

    <!-- 数据表字段属性 -->
    <sql id="selectAppArticleVo">
        select id,
               type,
               classify,
               thumbnail,
               title,
               content,
               bz,
               status,
               seq,
               is_delete,
               createdate,
               modifydate
        from md_app_article
    </sql>

    <!-- 查询列表数据 -->
    <select id="getPage" resultType="com.center.medical.appadmin.bean.vo.AppArticlePageVo">
        SELECT
            aa.id,
            aa.type,
            aa.classify,
            aat.name as classifyName,
            aa.thumbnail,
            aa.title,
            aa.bz,
            aa.status,
            aa.seq,
            aa.createdate
        FROM
            md_app_article aa
            left join md_app_article_type aat on aat.id = aa.classify
        <where>
            aa.is_delete = 0
            <if test="param.classify!=null and param.classify!=''">
                AND aa.classify = #{param.classify}
            </if>
            <if test="param.title!=null and param.title!=''">
                AND aa.title like concat('%',#{param.title},'%')
            </if>
            <if test="param.status!=null and param.status!=''">
                AND aa.status = #{param.status}
            </if>
        </where>
        order by aa.createdate DESC
    </select>

    <!-- 根据主键id获取记录详情 -->
    <select id="getInfoById" resultType="com.center.medical.appadmin.bean.model.AppArticle">
        select aa.id,
        aa.type,
        aa.classify,
        aa.thumbnail,
        aa.title,
        aa.content,
        aa.bz,
        aa.status,
        aa.seq,
        aa.is_delete,
        aa.createdate,
        aa.modifydate,
        aat.name as classifyName
        from md_app_article aa
        left join md_app_article_type aat on aat.id = aa.classify
        <where>
            aa.id = #{id}
        </where>
    </select>



    <!-- 查询列表数据 -->
    <select id="getArticleList" resultType="com.center.medical.appadmin.bean.vo.GetArticleListVo">
        SELECT
        aa.id,
        aa.type,
        aa.classify,
        aat.name as classifyName,
        aa.thumbnail,
        aa.title,
        aa.seq,
        STR_TO_DATE(aa.createdate,'%Y-%m-%d') as createdate
        FROM
        md_app_article aa
        left join md_app_article_type aat on aat.id = aa.classify
        <where>
            aa.is_delete = 0
            and aa.status = 1
            <if test="param.classify!=null and param.classify!=''">
                AND aa.classify = #{param.classify}
            </if>
        </where>
        order by aa.seq asc,aa.createdate DESC
    </select>
</mapper>

