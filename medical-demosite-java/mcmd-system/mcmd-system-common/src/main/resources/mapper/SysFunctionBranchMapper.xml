<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.center.medical.system.dao.SysFunctionBranchMapper">

    <resultMap type="com.center.medical.system.bean.model.SysFunctionBranch" id="SysFunctionBranchMap">
        <id property="id" column="id"/>
        <result property="functionId" column="function_id"/>
        <result property="branchId" column="branch_id"/>
        <result property="status" column="status"/>
        <result property="remark" column="remark"/>
        <result property="createBy" column="create_by"/>
        <result property="createTime" column="create_time"/>
        <result property="updateBy" column="update_by"/>
        <result property="updateTime" column="update_time"/>
    </resultMap>

    <!-- 数据表字段属性 -->
    <sql id="selectSysFunctionBranchVo">
        select id,
               function_id,
               branch_id,
               status,
               remark,
               create_by,
               create_time,
               update_by,
               update_time
        from sys_function_branch
    </sql>

    <!-- 查询列表数据 -->
    <select id="getPage" resultMap="SysFunctionBranchMap">
        <include refid="selectSysFunctionBranchVo"/>
    </select>

    <!-- 根据主键id获取记录详情 -->
    <select id="getInfoById" resultMap="SysFunctionBranchMap">
        <include refid="selectSysFunctionBranchVo"/>
        <where>
            id = #{id}
        </where>
    </select>


    <!-- 查询该分中心是否开启该业务 -->
    <select id="getByfunIdAndCid" resultType="java.lang.Integer">
        select count(*)
        from sys_function_branch sfb
        INNER JOIN sys_function sf on sfb.function_id = sf.function_id
        and sf.status = 0
        <where>
            sf.function_id = #{functionId}
            and sfb.branch_id = #{branchId}
            and sfb.status = 0
        </where>
    </select>
</mapper>

