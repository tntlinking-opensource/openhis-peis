<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.center.medical.pacs.dao.PacsBasexamltemMapper">
    <select id="getPage" resultType="com.center.medical.pacs.bean.vo.PacsBasexamltemVo">
        select
            b.id,
            b.examitem_name,
            b.f_male,
            b.input_code,
            d.dept_name,
            b.type,
            b.division_id
        from
            md_pacs_basexamltem b
        inner join
            sys_dept d on d.dept_no=b.division_id
        where
            b.is_delete=0
            <if test="pacsBasexamltemListParam.inputCode!=null and pacsBasexamltemListParam.inputCode!=''">
                and b.input_code like concat('%',#{pacsBasexamltemListParam.inputCode},'%')
            </if>
            <if test="pacsBasexamltemListParam.examitemName!=null and pacsBasexamltemListParam.examitemName!=''">
                and b.examitem_name like concat('%',#{pacsBasexamltemListParam.examitemName},'%')
            </if>
            <if test="pacsBasexamltemListParam.type!=null ">
                and b.type = #{pacsBasexamltemListParam.type}
            </if>
            <if test="pacsBasexamltemListParam.divisionId!=null and pacsBasexamltemListParam.divisionId!=''">
                and b.division_id = #{pacsBasexamltemListParam.divisionId}
            </if>
            <if test="pacsBasexamltemListParam.forMale!=null ">
                and b.f_male = #{pacsBasexamltemListParam.forMale}
            </if>
        order by b.modifydate desc,b.createdate desc
    </select>
    <sql id="signSql">
        select
            s.id,
            s.name,
            s.result_id,
            bc.name result_name,
            s.body_detail,
            s.intensive_level,
            s.is_positive,
            s.is_default,
            s.orderindex
        from
            md_pacs_basexamltem_sign s
        left join
            md_basconclusion bc on bc.id=s.result_id
        where
            s.is_delete=0
    </sql>
    <select id="getSignPage" resultType="com.center.medical.pacs.bean.vo.PacsBasexamltemSignVo">
        <include refid="signSql"/>
        and
            s.inspect_id=#{id}
        order by s.orderindex
    </select>
    <select id="getSignList" resultType="com.center.medical.pacs.bean.vo.PacsBasexamltemSignVo">
        <include refid="signSql"/>
        and
            s.inspect_id=#{id}
        order by s.orderindex
    </select>
    <select id="getConclusionList" resultType="com.center.medical.pacs.bean.vo.PacsConclusionVo">
        select
            con.id,
            con.name,
            con.input_code
        from
            md_basconclusion con
        where
            con.is_delete=0
            and con.audit_status=1
        <if test="inputCode!=null and inputCode!='' ">
            and con.input_code like concat('%',#{inputCode},'%')
        </if>
        order by con.name
    </select>
</mapper>